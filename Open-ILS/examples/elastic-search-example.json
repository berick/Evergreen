{
  "comment": "Elastic Search Configuration",
  "version": 0.1,
  "clusters": {
    "main": {
      "nodes": [
          "http://localhost:9200"
      ]
    }
  },
  "evergreen-database": {
    "host": "localhost",
    "port": 5432,
    "name": "evergreen",
    "user": "evergreen",
    "pass": "evergreen"
  },
  "indexes": {
    "bib-search": {
      "cluster": "main",
      "document-type": "bib-record",
      "lang_analyzer": "english",
      "settings": {
        "number_of_shards": 5,
        "analysis": {
          "analyzer": {
            "folding": {
              "filter": ["lowercase", "asciifolding"],
              "tokenizer": "standard"
            }
          }
        }
      },
      "base-properties": {
        "source": {
          "type": "integer",
          "index": "false"
        },
        "create_date": {
          "type": "date",
          "index": "false"
        },
        "edit_date": {
          "type": "date",
          "index": "false"
        },
        "title": {
          "type": "text",
          "analyzer": "english",
          "fields": {
            "folded": {
              "type": "text",
              "analyzer": "folding"
            },
            "raw": {
              "type": "keyword"
            }
          }
        },
        "author": {
          "type": "text",
          "analyzer": "english",
          "fields": {
            "folded": {
              "type": "text",
              "analyzer": "folding"
            },
            "raw": {
              "type": "keyword"
            }
          }
        },
        "subject": {
          "type": "text",
          "analyzer": "english",
          "fields": {
            "folded": {
              "type": "text",
              "analyzer": "folding"
            },
            "raw": {
              "type": "keyword"
            }
          }
        },
        "series": {
          "type": "text",
          "analyzer": "english",
          "fields": {
            "folded": {
              "type": "text",
              "analyzer": "folding"
            },
            "raw": {
              "type": "keyword"
            }
          }
        },
        "keyword": {
          "type": "text",
          "analyzer": "english",
          "fields": {
            "folded": {
              "type": "text",
              "analyzer": "folding"
            }
          }
        },
        "identifier": {
          "type": "keyword",
          "index": "false"
        },
        "holdings": {
          "type": "nested",
          "properties": {
            "status": {
              "type": "integer"
            },
            "circ_lib": {
              "type": "integer"
            },
            "location": {
              "type": "integer"
            },
            "circulate": {
              "type": "boolean"
            },
            "opac_visible": {
              "type": "boolean"
            }
          }
        }
      }
    }
  },
  "dynamic-properties": [
    {
      "index": "bib-search",
      "field_class": "title",
      "name" : "abbreviated",
      "label" : "Abbreviated Title",
      "format" : "mods32",
      "xpath" : "//mods32:mods/mods32:titleInfo[mods32:title and (@type='abbreviated')]"
    }, {
      "index": "bib-search",
      "field_class": "title",
      "name": "translated",
      "label": "Translated Title",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:titleInfo[mods32:title and (@type='translated-nfi')]"
    }, {
      "index": "bib-search",
      "field_class": "title",
      "name": "alternative",
      "label": "Alternate Title",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:titleInfo[mods32:title and starts-with(@type,'alternative')]"
    }, {
      "index": "bib-search",
      "field_class": "title",
      "name": "uniform",
      "label": "Uniform Title",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:titleInfo[mods32:title and (@type='uniform-nfi')]"
    }, {
      "index": "bib-search",
      "field_class": "title",
      "name": "proper",
      "label": "Title Proper",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:titleNonfiling[mods32:title and not (@type)]"
    }, {
      "index": "bib-search",
      "field_class": "author",
      "name": "corporate",
      "label": "Corporate Author",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:name[@type='corporate' and (mods32:role/mods32:roleTerm[text()='creator'] or mods32:role/mods32:roleTerm[text()='aut'] or mods32:role/mods32:roleTerm[text()='cre'])]//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "author",
      "name": "personal",
      "label": "Personal Author",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:name[@type='personal' and mods32:role/mods32:roleTerm[text()='creator']]//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "author",
      "name": "conference",
      "label": "Conference Author",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:name[@type='conference' and mods32:role/mods32:roleTerm[text()='creator']]//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "author",
      "name": "other",
      "label": "Other Author",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:name[@type='personal' and not(mods32:role/mods32:roleTerm[text()='creator'])]//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "keyword",
      "label": "General Keywords",
      "format": "mods32",
      "xpath": "//mods32:mods/*[not(local-name()='originInfo')]"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "accession",
      "label": "Accession Number",
      "format": "marcxml",
      "xpath": "//marc:controlfield[@tag='001']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "isbn",
      "label": "ISBN",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='020']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "ismn",
      "label": "ISMN",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='024' and @ind1='2']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "ean",
      "label": "EAN",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='024' and @ind1='3']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "isrc",
      "label": "ISRC",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='024' and @ind1='0']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "sici",
      "label": "SICI",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='024' and @ind1='4']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "bibcn",
      "label": "Local Free-Text Call Number",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='099']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "bibid",
      "label": "Internal ID",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='901']/marc:subfield[@code='c']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "scn",
      "label": "System Control Number",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='035']/marc:subfield[@code='a']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "lccn",
      "label": "LC Control Number",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='010']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "genre",
      "label": "Genre",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='655']//*[local-name()='subfield' and contains('abvxyz',@code)]"
    }, {
      "index": "bib-search",
      "field_class": "subject",
      "name": "complete",
      "label": "All Subjects",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:subject[not(descendant::mods32:geographicCode)]"
    }, {
      "index": "bib-search",
      "field_class": "author",
      "name": "creator",
      "label": "All Creators",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:name[mods32:role/mods32:roleTerm[text()='creator']]//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "edition",
      "label": "Edition",
      "format": "mods33",
      "xpath": "//mods33:mods/mods33:originInfo//mods33:edition[1]"
    }, {
      "index": "bib-search",
      "field_class": "series",
      "name": "seriestitle",
      "label": "Series Title",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:relatedItem[@type='series']/mods32:titleInfo[not(@type='nfi')]"
    }, {
      "index": "bib-search",
      "field_class": "subject",
      "name": "name",
      "label": "Name Subject",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:subject/mods32:name//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "issn",
      "label": "ISSN",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='022']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "upc",
      "label": "UPC",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='024' and @ind1='1']/marc:subfield[@code='a' or @code='z']"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "tcn",
      "label": "Title Control Number",
      "format": "marcxml",
      "xpath": "//marc:datafield[@tag='901']/marc:subfield[@code='a']"
    }, {
      "index": "bib-search",
      "field_class": "subject",
      "name": "geographic",
      "label": "Geographic Subject",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:subject/mods32:geographic"
    }, {
      "index": "bib-search",
      "field_class": "subject",
      "name": "temporal",
      "label": "Temporal Subject",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:subject/mods32:temporal"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "physical_description",
      "label": "Physical Descrption",
      "format": "mods33",
      "xpath": "(//mods33:mods/mods33:physicalDescription/mods33:form|//mods33:mods/mods33:physicalDescription/mods33:extent|//mods33:mods/mods33:physicalDescription/mods33:reformattingQuality|//mods33:mods/mods33:physicalDescription/mods33:internetMediaType|//mods33:mods/mods33:physicalDescription/mods33:digitalOrigin)"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "publisher",
      "label": "Publisher",
      "format": "mods33",
      "xpath": "//mods33:mods/mods33:originInfo//mods33:publisher[1]"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "abstract",
      "label": "Abstract",
      "format": "mods33",
      "xpath": "//mods33:mods/mods33:abstract"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "toc",
      "label": "Table of Contents",
      "format": "mods33",
      "xpath": "//mods33:tableOfContents"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "bibliography",
      "label": "Bibliography",
      "format": "mods33",
      "xpath": "//mods33:note[@type='bibliography']"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "thesis",
      "label": "Thesis",
      "format": "mods33",
      "xpath": "//mods33:note[@type='thesis']"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "production_credits",
      "label": "Creation/Production Credits",
      "format": "mods33",
      "xpath": "//mods33:note[@type='creation/production credits']"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "performers",
      "label": "Performers",
      "format": "mods33",
      "xpath": "//mods33:note[@type='performers']"
    }, {
      "index": "bib-search",
      "field_class": "keyword",
      "name": "general_note",
      "label": "General Note",
      "format": "mods33",
      "xpath": "//mods33:note[not(@type)]"
    }, {
      "index": "bib-search",
      "field_class": "author",
      "name": "first_author",
      "label": "Author",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:name[mods32:role/mods32:roleTerm[text()='creator']][1]//*[local-name()='namePart']"
    }, {
      "index": "bib-search",
      "field_class": "title",
      "name": "maintitle",
      "label": "Main Title",
      "format": "marcxml",
      "xpath": "//*[@tag='245']/*[@code='a']"
    }, {
      "index": "bib-search",
      "field_class": "subject",
      "name": "topic",
      "label": "Topic Subject",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:subject/mods32:topic"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "item_lang",
      "label": "Language",
      "format": "marcxml",
      "xpath": "substring(//marc:controlfield[@tag='008']/text(), '36', '3')"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "item_form",
      "label": "Item Form",
      "format": "marcxml",
      "xpath": "substring(//marc:controlfield[@tag='008']/text(), '24', '1')"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "audience",
      "label": "Audience",
      "format": "marcxml",
      "xpath": "substring(//marc:controlfield[@tag='008']/text(), '23', '1')"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "lit_form",
      "label": "Literary Form",
      "format": "marcxml",
      "xpath": "substring(//marc:controlfield[@tag='008']/text(), '34', '1')"
    }, {
      "index": "bib-search",
      "field_class": "identifier",
      "name": "pub_date",
      "label": "Publication Date",
      "format": "mods32",
      "xpath": "//mods32:mods/mods32:originInfo/mods32:dateIssued[@encoding='marc']"
    }
  ]
}

